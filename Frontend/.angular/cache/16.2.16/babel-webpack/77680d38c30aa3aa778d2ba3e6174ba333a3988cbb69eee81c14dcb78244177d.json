{"ast":null,"code":"import { CreateCommunityComponent } from '../dialog/create-community/create-community.component';\nimport { DialogElementsExampleDialogComponent } from '../dialog-elements-example-dialog/dialog-elements-example-dialog.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/material/dialog\";\nimport * as i2 from \"../service/community.service\";\nimport * as i3 from \"../service/user.service\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/material/button\";\nconst _c0 = function (a1) {\n  return [\"/discussion\", a1];\n};\nfunction CommunityHomepageComponent_ul_9_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 27);\n    i0.ɵɵtext(1, \"Message\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const data_r2 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(1, _c0, data_r2.id));\n  }\n}\nfunction CommunityHomepageComponent_ul_9_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 28);\n    i0.ɵɵlistener(\"click\", function CommunityHomepageComponent_ul_9_div_14_Template_div_click_0_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const data_r2 = i0.ɵɵnextContext().$implicit;\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.joinCommunity(data_r2.id));\n    });\n    i0.ɵɵtext(1, \"Join\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CommunityHomepageComponent_ul_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ul\", 16)(1, \"li\", 17)(2, \"div\", 18)(3, \"div\", 19);\n    i0.ɵɵelement(4, \"img\", 20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 21)(6, \"p\", 22);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"div\", 23)(9, \"span\");\n    i0.ɵɵtext(10, \" Book :\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(12, \"div\", 24);\n    i0.ɵɵtemplate(13, CommunityHomepageComponent_ul_9_div_13_Template, 2, 3, \"div\", 25);\n    i0.ɵɵtemplate(14, CommunityHomepageComponent_ul_9_div_14_Template, 2, 0, \"div\", 26);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const data_r2 = ctx.$implicit;\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(8, _c0, data_r2.id))(\"src\", \"data:image/png;base64,\" + data_r2.book.bookImage.image, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(10, _c0, data_r2.id));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", data_r2.title, \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(12, _c0, data_r2.id));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", data_r2.book.title, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", data_r2.member);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !data_r2.member);\n  }\n}\nfunction CommunityHomepageComponent_li_17_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"li\", 11)(1, \"a\", 29);\n    i0.ɵɵlistener(\"click\", function CommunityHomepageComponent_li_17_Template_a_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r12);\n      const page_r10 = restoredCtx.$implicit;\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.onPageChange(page_r10));\n    });\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const page_r10 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵclassProp(\"active\", page_r10 === ctx_r1.currentPage);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(page_r10);\n  }\n}\nlet CommunityHomepageComponent = /*#__PURE__*/(() => {\n  class CommunityHomepageComponent {\n    constructor(dialog, communityService, userService, route) {\n      this.dialog = dialog;\n      this.communityService = communityService;\n      this.userService = userService;\n      this.route = route;\n      this.community = [];\n      this.role = [];\n      this.roles = [];\n      this.member = [];\n      this.user = {\n        id: -1,\n        firstName: '',\n        lastName: '',\n        email: ''\n      };\n      this.currentPage = 0;\n      this.pageSize = 5;\n      this.totalPages = 0;\n      this.pages = [];\n    }\n    openDialog() {\n      if (this.userService.isLoggedIn()) {\n        const dialogRef = this.dialog.open(CreateCommunityComponent, {\n          data: {\n            title: this.title,\n            bookId: this.bookId\n          }\n        });\n        dialogRef.afterClosed().subscribe(result => {\n          console.log(result);\n          this.communityService.createCommunity(result.title, result.bookId).subscribe(res => {\n            alert(res);\n            console.log(res);\n            window.location.reload();\n          });\n        });\n      } else {\n        this.dialog.open(DialogElementsExampleDialogComponent);\n      }\n    }\n    ngOnInit() {\n      this.userService.getUser().subscribe(res => {\n        this.user = res;\n      });\n      this.loadItems();\n    }\n    loadItems() {\n      this.communityService.getPagedItems(this.currentPage, this.pageSize).subscribe(page => {\n        this.community = page.content;\n        console.log(this.community);\n        for (let i = 0; i < this.community.length; i++) {\n          for (let j = 0; j < this.community[i].members.length; j++) {\n            console.log(this.user.id, this.community[i].members[j].id);\n            if (this.user.id == this.community[i].members[j].id) {\n              this.member[i] = true;\n              break;\n            }\n          }\n        }\n        console.log(this.member);\n        this.community.forEach((i, index) => this.role[index] = i.creator.authority[0].role);\n        const roles = this.role.map(role => role.replace('ROLE_', ''));\n        this.roles = roles;\n        this.totalPages = page.totalPages;\n        this.pages = Array.from({\n          length: this.totalPages\n        }, (_, i) => i + 1);\n        // Log the data after the asynchronous call is complete\n      });\n    }\n\n    onPageChange(newPage) {\n      // Adjust the condition based on your indexing\n      if (newPage >= 1 && newPage - 1 < this.totalPages) {\n        // this.member = false\n        this.currentPage = newPage;\n        this.loadItems();\n      }\n    }\n    joinCommunity(id) {\n      this.communityService.joinCommunity(id).subscribe(res => {\n        console.log(res);\n        this.route.navigate(['/discussion', id]);\n      });\n    }\n    static {\n      this.ɵfac = function CommunityHomepageComponent_Factory(t) {\n        return new (t || CommunityHomepageComponent)(i0.ɵɵdirectiveInject(i1.MatDialog), i0.ɵɵdirectiveInject(i2.CommunityService), i0.ɵɵdirectiveInject(i3.UserService), i0.ɵɵdirectiveInject(i4.Router));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: CommunityHomepageComponent,\n        selectors: [[\"app-community-homepage\"]],\n        decls: 22,\n        vars: 6,\n        consts: [[1, \"container\", \"mx-auto\", \"flex\", \"justify-center\", \"my-3\"], [\"mat-raised-button\", \"\", 3, \"click\"], [1, \"container\", \"mx-auto\", \"flex\", \"justify-center\"], [1, \"w-full\", \"max-w-md\", \"p-4\", \"bg-white\", \"border\", \"border-gray-200\", \"rounded-lg\", \"shadow\", \"sm:p-8\", \"dark:bg-gray-800\", \"dark:border-gray-700\"], [1, \"flex\", \"items-center\", \"justify-between\", \"mb-4\"], [1, \"text-xl\", \"font-bold\", \"leading-none\", \"text-gray-900\", \"dark:text-white\"], [1, \"flow-root\"], [\"role\", \"list\", \"class\", \"divide-y divide-gray-200 dark:divide-gray-700\", 4, \"ngFor\", \"ngForOf\"], [1, \"container\", \"mx-auto\", \"flex\", \"justify-center\", \"items-center\", \"my-4\"], [\"aria-label\", \"Page navigation example\"], [1, \"pagination\"], [1, \"page-item\"], [\"aria-label\", \"Previous\", 1, \"page-link\", 3, \"click\"], [\"aria-hidden\", \"true\"], [\"class\", \"page-item\", 3, \"active\", 4, \"ngFor\", \"ngForOf\"], [\"aria-label\", \"Next\", 1, \"page-link\", 3, \"click\"], [\"role\", \"list\", 1, \"divide-y\", \"divide-gray-200\", \"dark:divide-gray-700\"], [1, \"py-3\", \"sm:py-4\"], [1, \"flex\", \"items-center\"], [1, \"flex-shrink-0\"], [\"alt\", \"Neil image\", 1, \"w-12\", \"h-12\", \"rounded-full\", \"cursor-pointer\", 3, \"routerLink\", \"src\"], [1, \"flex-1\", \"min-w-0\", \"ms-4\"], [1, \"text-sm\", \"cursor-pointer\", \"font-medium\", \"text-gray-900\", \"truncate\", \"dark:text-white\", 3, \"routerLink\"], [1, \"text-sm\", \"cursor-pointer\", \"text-gray-500\", \"truncate\", \"dark:text-gray-400\", 3, \"routerLink\"], [1, \"inline-flex\", \"items-center\", \"text-base\", \"font-semibold\", \"text-gray-900\", \"dark:text-white\"], [\"class\", \"inline-flex cursor-pointer items-center px-4 py-2 text-sm font-medium text-center text-gray-900 bg-white border border-gray-300 rounded-lg hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-200 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-700 dark:focus:ring-gray-700 ms-3\", 3, \"routerLink\", 4, \"ngIf\"], [\"class\", \"inline-flex cursor-pointer items-center px-4 py-2 text-sm font-medium text-center text-white bg-green-600 rounded-lg hover:bg-green-800 focus:ring-4 focus:outline-none focus:ring-green-300 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800\", 3, \"click\", 4, \"ngIf\"], [1, \"inline-flex\", \"cursor-pointer\", \"items-center\", \"px-4\", \"py-2\", \"text-sm\", \"font-medium\", \"text-center\", \"text-gray-900\", \"bg-white\", \"border\", \"border-gray-300\", \"rounded-lg\", \"hover:bg-gray-100\", \"focus:ring-4\", \"focus:outline-none\", \"focus:ring-gray-200\", \"dark:bg-gray-800\", \"dark:text-white\", \"dark:border-gray-600\", \"dark:hover:bg-gray-700\", \"dark:hover:border-gray-700\", \"dark:focus:ring-gray-700\", \"ms-3\", 3, \"routerLink\"], [1, \"inline-flex\", \"cursor-pointer\", \"items-center\", \"px-4\", \"py-2\", \"text-sm\", \"font-medium\", \"text-center\", \"text-white\", \"bg-green-600\", \"rounded-lg\", \"hover:bg-green-800\", \"focus:ring-4\", \"focus:outline-none\", \"focus:ring-green-300\", \"dark:bg-green-600\", \"dark:hover:bg-green-700\", \"dark:focus:ring-green-800\", 3, \"click\"], [1, \"page-link\", 3, \"click\"]],\n        template: function CommunityHomepageComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"button\", 1);\n            i0.ɵɵlistener(\"click\", function CommunityHomepageComponent_Template_button_click_1_listener() {\n              return ctx.openDialog();\n            });\n            i0.ɵɵtext(2, \"Create Community\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(3, \"div\", 2)(4, \"div\", 3)(5, \"div\", 4)(6, \"h2\", 5);\n            i0.ɵɵtext(7, \" Communities \");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(8, \"div\", 6);\n            i0.ɵɵtemplate(9, CommunityHomepageComponent_ul_9_Template, 15, 14, \"ul\", 7);\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(10, \"div\", 8)(11, \"nav\", 9)(12, \"ul\", 10)(13, \"li\", 11)(14, \"a\", 12);\n            i0.ɵɵlistener(\"click\", function CommunityHomepageComponent_Template_a_click_14_listener() {\n              return ctx.onPageChange(ctx.currentPage - 1);\n            });\n            i0.ɵɵelementStart(15, \"span\", 13);\n            i0.ɵɵtext(16, \"\\u00AB\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵtemplate(17, CommunityHomepageComponent_li_17_Template, 3, 3, \"li\", 14);\n            i0.ɵɵelementStart(18, \"li\", 11)(19, \"a\", 15);\n            i0.ɵɵlistener(\"click\", function CommunityHomepageComponent_Template_a_click_19_listener() {\n              return ctx.onPageChange(ctx.currentPage + 1);\n            });\n            i0.ɵɵelementStart(20, \"span\", 13);\n            i0.ɵɵtext(21, \"\\u00BB\");\n            i0.ɵɵelementEnd()()()()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(9);\n            i0.ɵɵproperty(\"ngForOf\", ctx.community);\n            i0.ɵɵadvance(4);\n            i0.ɵɵclassProp(\"disabled\", ctx.currentPage === 1);\n            i0.ɵɵadvance(4);\n            i0.ɵɵproperty(\"ngForOf\", ctx.pages);\n            i0.ɵɵadvance(1);\n            i0.ɵɵclassProp(\"disabled\", ctx.currentPage === ctx.totalPages);\n          }\n        },\n        dependencies: [i5.NgForOf, i5.NgIf, i4.RouterLink, i6.MatButton]\n      });\n    }\n  }\n  return CommunityHomepageComponent;\n})();\nexport { CommunityHomepageComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}